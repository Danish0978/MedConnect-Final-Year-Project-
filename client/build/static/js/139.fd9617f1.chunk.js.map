{"version":3,"file":"static/js/139.fd9617f1.chunk.js","mappings":"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","sources":["pages/Appointments.jsx","components/FeedbackModal.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Empty from \"../components/Empty\";\nimport Footer from \"../components/Footer\";\nimport Navbar from \"../components/Navbar\";\nimport fetchData from \"../helper/apiCall\";\nimport { setLoading } from \"../redux/reducers/rootSlice\";\nimport Loading from \"../components/Loading\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport toast from \"react-hot-toast\";\nimport \"../styles/user.css\";\nimport { useNavigate } from \"react-router-dom\";\nimport FeedbackModal from \"../components/FeedbackModal\"; // We'll create this next\n\nconst Appointments = () => {\n  const [appointments, setAppointments] = useState([]);\n  const [selectedAppointment, setSelectedAppointment] = useState(null);\n  const [feedbackModalOpen, setFeedbackModalOpen] = useState(false);\n  const [feedbackExists, setFeedbackExists] = useState({});\n  const dispatch = useDispatch();\n  const { loading } = useSelector((state) => state.root);\n  const { userId, isDoctor, isReceptionist } = jwt_decode(localStorage.getItem(\"token\"));\n  const navigate = useNavigate();\n\n  const getAllAppoint = async () => {\n    try {\n      dispatch(setLoading(true));\n      const temp = await fetchData(`/appointment/getappointments`);\n      setAppointments(temp);\n      \n      // Check feedback existence for each completed appointment\n      const feedbackChecks = await Promise.all(\n        temp\n          .filter(appt => appt.status === \"Completed\" && !isDoctor)\n          .map(appt => \n            axios.get(`/feedback/exists/appointment/${appt._id}`, {\n              headers: {\n                Authorization: `Bearer ${localStorage.getItem(\"token\")}`\n              }\n            })\n          )\n      );\n      \n      const feedbackMap = {};\n      feedbackChecks.forEach((res, index) => {\n        const apptId = temp.filter(appt => appt.status === \"Completed\" && !isDoctor)[index]._id;\n        feedbackMap[apptId] = res.data.exists;\n      });\n      \n      setFeedbackExists(feedbackMap);\n      dispatch(setLoading(false));\n    } catch (error) {\n      console.error(error);\n      dispatch(setLoading(false));\n    }\n  };\n\n  useEffect(() => {\n    getAllAppoint();\n  }, []);\n\n  const complete = async (ele) => {\n    try {\n      const { data } = await toast.promise(\n        axios.put(\n          \"/appointment/completed\",\n          {\n            appointid: ele?._id,\n            doctorId: ele?.doctorId?._id,\n            doctorname: `${ele?.userId?.firstname} ${ele?.userId?.lastname}`,\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"token\")}`,\n            },\n          }\n        ),\n        {\n          success: \"Appointment completed successfully\",\n          error: \"Unable to complete appointment\",\n          loading: \"Completing appointment...\",\n        }\n      );\n\n      await getAllAppoint();\n    } catch (error) {\n      return error;\n    }\n  };\n\n  const openFeedbackModal = (appointment) => {\n    setSelectedAppointment(appointment);\n    setFeedbackModalOpen(true);\n  };\n\n  const handleFeedbackSubmit = async () => {\n    await getAllAppoint(); // Refresh to update feedback status\n    setFeedbackModalOpen(false);\n  };\n\n  const navigateToAddPrescription = (appointment) => {\n    navigate(\"/add-prescription\", {\n      state: {\n        appointmentId: appointment._id,\n        patientId: appointment.userId._id,\n        doctorId: appointment.doctorId._id,\n      },\n    });\n  };\n\n  return (\n    <>\n      <Navbar />\n      {loading ? (\n        <Loading />\n      ) : (\n        <section className=\"container notif-section\">\n          <h2 className=\"page-heading\">Your Appointments</h2>\n\n          {appointments.length > 0 ? (\n            <div className=\"appointments-container\">\n              <table className=\"appointments-table\">\n                <thead>\n                  <tr>\n                    <th>S.No</th>\n                    <th>Doctor</th>\n                    <th>Patient</th>\n                    <th>Appointment Date</th>\n                    <th>Appointment Time</th>\n                    <th>Booking Date</th>\n                    <th>Booking Time</th>\n                    <th>Status</th>\n                    {isDoctor ? <th>Action</th> : (isReceptionist ? null : <th>Review</th>)}\n                  </tr>\n                </thead>\n                <tbody>\n                  {appointments?.map((ele, i) => {\n                    return (\n                      <tr key={ele?._id}>\n                        <td>{i + 1}</td>\n                        <td>\n                          {ele?.doctorId?.firstname + \" \" + ele?.doctorId?.lastname}\n                        </td>\n                        <td>\n                          {ele?.userId?.firstname + \" \" + ele?.userId?.lastname}\n                        </td>\n                        <td>{ele?.date}</td>\n                        <td>{ele?.time}</td>\n                        <td>{ele?.createdAt.split(\"T\")[0]}</td>\n                        <td>{ele?.updatedAt.split(\"T\")[1].split(\".\")[0]}</td>\n                        <td>{ele?.status}</td>\n                        {isDoctor ? (\n                          <td>\n                            <div className=\"action-buttons\">\n                              <button\n                                className={`accept-btn ${\n                                  ele?.status === \"Completed\" ? \"disable-btn\" : \"\"\n                                }`}\n                                disabled={ele?.status === \"Completed\"}\n                                onClick={() => complete(ele)}\n                              >\n                                Complete\n                              </button>\n                              <button\n                                className={`prescription-btn ${\n                                  ele?.status === \"Completed\" ? \"disable-btn\" : \"\"\n                                }`}\n                                disabled={ele?.status === \"Completed\"}\n                                onClick={() => navigateToAddPrescription(ele)}\n                              >\n                                Add Prescription\n                              </button>\n                            </div>\n                          </td>\n                        ) : (\n                          !isReceptionist && (\n                            <td>\n                              <button\n                                className={`review-btn ${\n                                  ele?.status !== \"Completed\" || feedbackExists[ele._id] \n                                    ? \"disable-btn\" \n                                    : \"\"\n                                }`}\n                                disabled={ele?.status !== \"Completed\" || feedbackExists[ele._id]}\n                                onClick={() => openFeedbackModal(ele)}\n                              >\n                                {feedbackExists[ele._id] ? \"Reviewed\" : \"Leave Review\"}\n                              </button>\n                            </td>\n                          )\n                        )}\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          ) : (\n            <Empty />\n          )}\n        </section>\n      )}\n\n\n{feedbackModalOpen && (\n  <FeedbackModal\n    appointment={selectedAppointment}\n    onClose={() => setFeedbackModalOpen(false)}\n    onSubmit={handleFeedbackSubmit}\n    entityType=\"doctor\" // Add this line\n    entityId={selectedAppointment?.doctorId?._id} // Add this line\n  />\n)}\n      \n      <Footer />\n    </>\n  );\n};\n\nexport default Appointments;","import React, { useState } from 'react';\r\nimport { FaStar } from 'react-icons/fa';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport '../styles/feedback.css';\r\n\r\n// Update your existing FeedbackModal component to handle both doctor and pharmacy reviews\r\nconst FeedbackModal = ({ order, appointment, onClose, onSubmit, entityType, entityId }) => {\r\n    const [rating, setRating] = useState(0);\r\n    const [hover, setHover] = useState(null);\r\n    const [comment, setComment] = useState('');\r\n    const [submitting, setSubmitting] = useState(false);\r\n  \r\n    const entityName = entityType === 'doctor' \r\n      ? `${appointment?.doctorId?.firstname} ${appointment?.doctorId?.lastname}`\r\n      : order?.pharmacy?.name;\r\n  \r\n      const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        \r\n        // Validate rating is selected\r\n        if (rating === 0) {\r\n          toast.error('Please select a rating');\r\n          return;\r\n        }\r\n      \r\n        setSubmitting(true);\r\n      \r\n        try {\r\n          // Validate we have the required data\r\n          if (!entityType) {\r\n            throw new Error('Missing entity type');\r\n          }\r\n          if (!entityId) {\r\n            throw new Error('Missing entity Id');\r\n          }\r\n          // Prepare the base payload\r\n          const payload = {\r\n            type: entityType,\r\n            entityId: entityId,\r\n            rating: rating,\r\n            comment: comment || ''\r\n          };\r\n      \r\n          // Add the reference ID based on entity type\r\n          if (entityType === 'doctor') {\r\n            if (!appointment?._id) {\r\n              throw new Error('Appointment information is missing');\r\n            }\r\n            payload.appointmentId = appointment._id;\r\n          } else {\r\n            if (!order?._id) {\r\n              throw new Error('Order information is missing');\r\n            }\r\n            payload.orderId = order._id;\r\n          }\r\n      \r\n          console.log('Submitting feedback with payload:', payload); // Debug log\r\n      \r\n          await toast.promise(\r\n            axios.post(\r\n              '/feedback/submit',\r\n              payload,\r\n              {\r\n                headers: {\r\n                  Authorization: `Bearer ${localStorage.getItem('token')}`,\r\n                  'Content-Type': 'application/json'\r\n                }\r\n              }\r\n            ),\r\n            {\r\n              loading: 'Submitting feedback...',\r\n              success: 'Feedback submitted successfully!',\r\n              error: (err) => {\r\n                return err.response?.data?.message || err.message || 'Failed to submit feedback';\r\n              }\r\n            }\r\n          );\r\n          \r\n          onSubmit();\r\n        } catch (error) {\r\n          console.error('Feedback submission error:', error);\r\n          toast.error(error.message);\r\n        } finally {\r\n          setSubmitting(false);\r\n        }\r\n      };\r\n  \r\n    return (\r\n      <div className=\"feedback-modal-overlay\">\r\n        <div className=\"feedback-modal\">\r\n          <button className=\"close-btn\" onClick={onClose}>×</button>\r\n          <h2>Rate Your Experience</h2>\r\n          <p>How was your {entityType === 'doctor' ? 'appointment' : 'order'} with {entityName}?</p>\r\n          \r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"star-rating\">\r\n              {[...Array(5)].map((star, i) => {\r\n                const ratingValue = i + 1;\r\n                return (\r\n                  <label key={i}>\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"rating\"\r\n                      value={ratingValue}\r\n                      onClick={() => setRating(ratingValue)}\r\n                    />\r\n                    <FaStar\r\n                      className=\"star\"\r\n                      color={ratingValue <= (hover || rating) ? \"#ffc107\" : \"#e4e5e9\"}\r\n                      size={40}\r\n                      onMouseEnter={() => setHover(ratingValue)}\r\n                      onMouseLeave={() => setHover(null)}\r\n                    />\r\n                  </label>\r\n                );\r\n              })}\r\n            </div>\r\n            \r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"comment\">Your Feedback (optional)</label>\r\n              <textarea\r\n                id=\"comment\"\r\n                rows=\"4\"\r\n                value={comment}\r\n                onChange={(e) => setComment(e.target.value)}\r\n                placeholder={`Share details about your ${entityType === 'doctor' ? 'appointment' : 'order'} experience...`}\r\n              />\r\n            </div>\r\n            \r\n            <button \r\n              type=\"submit\" \r\n              className=\"submit-btn\"\r\n              disabled={rating === 0 || submitting}\r\n            >\r\n              {submitting ? 'Submitting...' : 'Submit Feedback'}\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\nexport default FeedbackModal;"],"names":["Appointments","_selectedAppointment$","appointments","setAppointments","useState","selectedAppointment","setSelectedAppointment","feedbackModalOpen","setFeedbackModalOpen","feedbackExists","setFeedbackExists","dispatch","useDispatch","loading","useSelector","state","root","userId","isDoctor","isReceptionist","jwt_decode","localStorage","getItem","navigate","useNavigate","getAllAppoint","async","setLoading","temp","fetchData","feedbackChecks","Promise","all","filter","appt","status","map","axios","get","_id","headers","Authorization","feedbackMap","forEach","res","index","apptId","data","exists","error","console","useEffect","_jsxs","_Fragment","children","_jsx","Navbar","Loading","className","length","ele","i","_ele$doctorId2","_ele$doctorId3","_ele$userId3","_ele$userId4","doctorId","firstname","lastname","date","time","createdAt","split","updatedAt","disabled","onClick","_ele$doctorId","_ele$userId","_ele$userId2","toast","promise","put","appointid","doctorname","success","complete","appointment","appointmentId","patientId","Empty","FeedbackModal","onClose","onSubmit","entityType","entityId","Footer","_ref","_appointment$doctorId","_appointment$doctorId2","_order$pharmacy","order","rating","setRating","hover","setHover","comment","setComment","submitting","setSubmitting","entityName","pharmacy","name","e","preventDefault","Error","payload","type","orderId","log","post","err","_err$response","_err$response$data","response","message","Array","star","ratingValue","value","FaStar","color","size","onMouseEnter","onMouseLeave","htmlFor","id","rows","onChange","target","placeholder"],"sourceRoot":""}